<svg width="1280" height="780" viewBox="0 0 1280 780" fill="none" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="modalBg" x1="260" y1="70" x2="1020" y2="710" gradientUnits="userSpaceOnUse">
      <stop stop-color="#0F172A"/>
      <stop offset="1" stop-color="#111827"/>
    </linearGradient>
    <linearGradient id="runningBadge" x1="0" y1="0" x2="1" y2="1">
      <stop stop-color="#F59E0B"/>
      <stop offset="1" stop-color="#F97316"/>
    </linearGradient>
    <filter id="shadow" x="180" y="30" width="920" height="740" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
      <feDropShadow dx="0" dy="20" stdDeviation="24" flood-color="#000" flood-opacity="0.4"/>
    </filter>
  </defs>

  <rect width="1280" height="780" fill="#020617"/>
  <rect width="1280" height="780" fill="#000" fill-opacity="0.58"/>

  <g filter="url(#shadow)">
    <rect x="220" y="70" width="840" height="640" rx="20" fill="url(#modalBg)"/>
    <rect x="220.5" y="70.5" width="839" height="639" rx="19.5" stroke="#334155"/>
  </g>

  <!-- header -->
  <rect x="220" y="70" width="840" height="78" rx="20" fill="#0B1220"/>
  <line x1="220" y1="148.5" x2="1060" y2="148.5" stroke="#334155"/>
  <circle cx="258" cy="109" r="12" fill="#2563EB"/>
  <path d="M251 109h14M258 102v14" stroke="#DBEAFE" stroke-width="2" stroke-linecap="round"/>
  <text x="282" y="104" fill="#E5E7EB" font-family="Inter, Arial, sans-serif" font-size="18" font-weight="700">Run Sub-Agent</text>
  <text x="282" y="126" fill="#94A3B8" font-family="Inter, Arial, sans-serif" font-size="12">mcp_sub_agent_router_run_sub_agent</text>

  <rect x="882" y="90" width="120" height="34" rx="17" fill="url(#runningBadge)"/>
  <circle cx="904" cy="107" r="5" fill="#FEF3C7"/>
  <text x="918" y="112" fill="#FFFBEB" font-family="Inter, Arial, sans-serif" font-size="12" font-weight="700">RUNNING</text>

  <rect x="1018" y="88" width="30" height="30" rx="9" fill="#111827" stroke="#374151"/>
  <path d="M1027 97l12 12M1039 97l-12 12" stroke="#94A3B8" stroke-width="2" stroke-linecap="round"/>

  <!-- split columns -->
  <rect x="246" y="170" width="520" height="514" rx="14" fill="#0A0F1C"/>
  <rect x="246.5" y="170.5" width="519" height="513" rx="13.5" stroke="#1F2937"/>

  <rect x="780" y="170" width="254" height="514" rx="14" fill="#0A0F1C"/>
  <rect x="780.5" y="170.5" width="253" height="513" rx="13.5" stroke="#1F2937"/>

  <!-- left chat -->
  <rect x="504" y="198" width="236" height="88" rx="14" fill="#1E293B"/>
  <text x="520" y="224" fill="#93C5FD" font-family="Inter, Arial, sans-serif" font-size="12" font-weight="600">You</text>
  <text x="520" y="248" fill="#E2E8F0" font-family="Inter, Arial, sans-serif" font-size="13">agent_id: rust_dev_agent</text>
  <text x="520" y="268" fill="#E2E8F0" font-family="Inter, Arial, sans-serif" font-size="13">task: 修复构建并补回归测试</text>

  <rect x="272" y="312" width="448" height="174" rx="14" fill="#111827"/>
  <rect x="272.5" y="312.5" width="447" height="173" rx="13.5" stroke="#374151"/>
  <text x="290" y="338" fill="#A7F3D0" font-family="Inter, Arial, sans-serif" font-size="12" font-weight="600">Sub-Agent</text>
  <text x="290" y="362" fill="#E2E8F0" font-family="Inter, Arial, sans-serif" font-size="13">已扫描 42 个文件，开始执行修复计划：</text>
  <text x="290" y="384" fill="#E2E8F0" font-family="Inter, Arial, sans-serif" font-size="13">1) 修正 tool result 解析</text>
  <text x="290" y="404" fill="#E2E8F0" font-family="Inter, Arial, sans-serif" font-size="13">2) 更新状态机 completed 标记</text>
  <text x="290" y="424" fill="#E2E8F0" font-family="Inter, Arial, sans-serif" font-size="13">3) 运行 npm build + cargo check</text>

  <rect x="290" y="444" width="152" height="30" rx="15" fill="#0F172A" stroke="#334155"/>
  <circle cx="312" cy="459" r="4" fill="#60A5FA">
    <animate attributeName="opacity" values="0.25;1;0.25" dur="1.2s" repeatCount="indefinite"/>
  </circle>
  <circle cx="328" cy="459" r="4" fill="#60A5FA">
    <animate attributeName="opacity" values="0.25;1;0.25" dur="1.2s" begin="0.2s" repeatCount="indefinite"/>
  </circle>
  <circle cx="344" cy="459" r="4" fill="#60A5FA">
    <animate attributeName="opacity" values="0.25;1;0.25" dur="1.2s" begin="0.4s" repeatCount="indefinite"/>
  </circle>
  <text x="360" y="464" fill="#93C5FD" font-family="Inter, Arial, sans-serif" font-size="12">streaming...</text>

  <rect x="272" y="504" width="448" height="162" rx="12" fill="#0B1220"/>
  <text x="290" y="526" fill="#94A3B8" font-family="Inter, Arial, sans-serif" font-size="12" font-weight="600">执行事件（简化）</text>
  <circle cx="292" cy="546" r="3" fill="#22C55E"/>
  <text x="304" y="550" fill="#CBD5E1" font-family="Inter, Arial, sans-serif" font-size="12">ai_tools_start · 2 tools</text>
  <circle cx="292" cy="570" r="3" fill="#F59E0B"/>
  <text x="304" y="574" fill="#CBD5E1" font-family="Inter, Arial, sans-serif" font-size="12">ai_tools_stream · code_editor patching...</text>
  <circle cx="292" cy="594" r="3" fill="#22C55E"/>
  <text x="304" y="598" fill="#CBD5E1" font-family="Inter, Arial, sans-serif" font-size="12">ai_tools_end · tests_runner success</text>
  <circle cx="292" cy="618" r="3" fill="#60A5FA"/>
  <text x="304" y="622" fill="#CBD5E1" font-family="Inter, Arial, sans-serif" font-size="12">ai_response_received · building final answer</text>

  <!-- right tools panel -->
  <text x="802" y="198" fill="#E5E7EB" font-family="Inter, Arial, sans-serif" font-size="13" font-weight="700">工具调用</text>

  <rect x="800" y="216" width="214" height="116" rx="12" fill="#111827" stroke="#374151"/>
  <circle cx="818" cy="238" r="4" fill="#22C55E"/>
  <text x="830" y="242" fill="#E5E7EB" font-family="Inter, Arial, sans-serif" font-size="12" font-weight="600">code_editor_apply_patch</text>
  <text x="818" y="262" fill="#94A3B8" font-family="Inter, Arial, sans-serif" font-size="11">args: file=sendMessage.ts</text>
  <text x="818" y="280" fill="#94A3B8" font-family="Inter, Arial, sans-serif" font-size="11">result: updated 42 lines</text>
  <rect x="818" y="294" width="64" height="20" rx="10" fill="#0B3B2E" stroke="#166534"/>
  <text x="850" y="308" text-anchor="middle" fill="#86EFAC" font-family="Inter, Arial, sans-serif" font-size="10" font-weight="700">DONE</text>

  <rect x="800" y="346" width="214" height="116" rx="12" fill="#111827" stroke="#374151"/>
  <circle cx="818" cy="368" r="4" fill="#F59E0B"/>
  <text x="830" y="372" fill="#E5E7EB" font-family="Inter, Arial, sans-serif" font-size="12" font-weight="600">tests_runner_execute</text>
  <text x="818" y="392" fill="#94A3B8" font-family="Inter, Arial, sans-serif" font-size="11">cmd: npm run build</text>
  <text x="818" y="410" fill="#94A3B8" font-family="Inter, Arial, sans-serif" font-size="11">stream: vite building for production...</text>
  <rect x="818" y="424" width="78" height="20" rx="10" fill="#3A2A10" stroke="#B45309"/>
  <text x="857" y="438" text-anchor="middle" fill="#FDE68A" font-family="Inter, Arial, sans-serif" font-size="10" font-weight="700">RUNNING</text>

  <rect x="800" y="476" width="214" height="190" rx="12" fill="#0B1220"/>
  <text x="818" y="498" fill="#94A3B8" font-family="Inter, Arial, sans-serif" font-size="11" font-weight="600">最终摘要</text>
  <text x="818" y="520" fill="#CBD5E1" font-family="Inter, Arial, sans-serif" font-size="11">- 修复 completed 状态判定</text>
  <text x="818" y="538" fill="#CBD5E1" font-family="Inter, Arial, sans-serif" font-size="11">- 弹框优先显示 final/result</text>
  <text x="818" y="556" fill="#CBD5E1" font-family="Inter, Arial, sans-serif" font-size="11">- 兼容 tools_end 包装结构</text>

  <rect x="928" y="632" width="86" height="28" rx="8" fill="#1D4ED8"/>
  <text x="971" y="650" text-anchor="middle" fill="#EFF6FF" font-family="Inter, Arial, sans-serif" font-size="12" font-weight="700">Close</text>
</svg>
